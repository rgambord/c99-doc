<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>G.5.1 Multiplicative operators &mdash; C99 Language Standard  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/brand.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="G.5.2 Additive operators" href="../2/index.html" />
    <link rel="prev" title="G.5 Binary operators" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            C99 Language Standard
              <img src="../../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a><div>
<h3>Quick search</h3>
<script>
  (function() {
    var cx = '......';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=071d6321bf4c049e7' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../foreword.html">Foreword</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../1/index.html">1. Scope</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2/index.html">2. Normative references</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../3/index.html">3. Terms, definitions, and symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../4/index.html">4. Conformance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../5/index.html">5. Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../6/index.html">6. Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../7/index.html">7. Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../8/index.html">Annex A</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../9/index.html">Annex B</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../10/index.html">Annex C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../11/index.html">Annex D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../12/index.html">Annex E</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../13/index.html">Annex F</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Annex G</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../1/index.html">G.1 Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2/index.html">G.2 Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../3/index.html">G.3 Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../4/index.html">G.4 Conversions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">G.5 Binary operators</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">G.5.1 Multiplicative operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2/index.html">G.5.2 Additive operators</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../6/index.html">G.6 Complex arithmetic &lt;complex.h&gt;</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../7/index.html">G.7 Type-generic math &lt;tgmath.h&gt;</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../15/index.html">Annex H</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../16/index.html">Annex I</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../17/index.html">Annex J</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../18/index.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">C99 Language Standard</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Annex G</a></li>
          <li class="breadcrumb-item"><a href="../index.html">G.5 Binary operators</a></li>
      <li class="breadcrumb-item active">G.5.1 Multiplicative operators</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="../index.html" class="btn btn-neutral float-left" title="G.5 Binary operators" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../2/index.html" class="btn btn-neutral float-right" title="G.5.2 Additive operators" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="g-5-1-multiplicative-operators">
<span id="g-5-1"></span><h1>G.5.1 Multiplicative operators<a class="headerlink" href="#g-5-1-multiplicative-operators" title="Permalink to this heading">ÔÉÅ</a></h1>
<p class="rubric">Semantics</p>
<div class="snum docutils container" id="g-5-1p1">
<p><a class="reference internal" href="#g-5-1p1"><span class="std std-ref">1</span></a></p>
</div>
<p>If one operand has real type and the other operand has imaginary type, then the result has imaginary type. If both operands have imaginary type, then the result has real type. (If either operand has complex type, then the result has complex type.)</p>
<div class="snum docutils container" id="g-5-1p2">
<p><a class="reference internal" href="#g-5-1p2"><span class="std std-ref">2</span></a></p>
</div>
<p>If the operands are not both complex, then the result and floating-point exception behavior of the * operator is defined by the usual mathematical formula:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>*                  u                   iv                 u + iv
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>x                  xu                i(xv)            (xu) + i(xv)
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>iy               i(yu)                -yv            (-yv) + i(yu)
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>x + iy       (xu) + i(yu)        (-yv) + i(xv)
</pre></div>
</div>
<div class="snum docutils container" id="g-5-1p3">
<p><a class="reference internal" href="#g-5-1p3"><span class="std std-ref">3</span></a></p>
</div>
<p>If the second operand is not complex, then the result and floating-point exception behavior of the / operator is defined by the usual mathematical formula:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/                   u                       iv
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>x                  x/u                 i(-x/v)
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>iy               i(y/u)                     y/v
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>x + iy       (x/u) + i(y/u)        (y/v) + i(-x/v)
</pre></div>
</div>
<div class="snum docutils container" id="g-5-1p4">
<p><a class="reference internal" href="#g-5-1p4"><span class="std std-ref">4</span></a></p>
</div>
<p>The * and / operators satisfy the following infinity properties for all real, imaginary, and complex operands:<a class="footnote-reference brackets" href="#note325" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
<ul class="simple">
<li><p>if one operand is an infinity and the other operand is a nonzero finite number or an infinity, then the result of the * operator is an infinity;</p></li>
<li><p>if the first operand is an infinity and the second operand is a finite number, then the result of the / operator is an infinity;</p></li>
<li><p>if the first operand is a finite number and the second operand is an infinity, then the result of the / operator is a zero;</p></li>
<li><p>if the first operand is a nonzero finite number or an infinity and the second operand is a zero, then the result of the / operator is an infinity.</p></li>
</ul>
<div class="snum docutils container" id="g-5-1p5">
<p><a class="reference internal" href="#g-5-1p5"><span class="std std-ref">5</span></a></p>
</div>
<p>If both operands of the * operator are complex or if the second operand of the / operator is complex, the operator raises floating-point exceptions if appropriate for the calculation of the parts of the result, and may raise spurious floating-point exceptions.</p>
<div class="snum docutils container" id="g-5-1p6">
<p><a class="reference internal" href="#g-5-1p6"><span class="std std-ref">6</span></a></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">EXAMPLE</span> <span class="pre">1</span></code> Multiplication of double _Complex operands could be implemented as follows. Note that the imaginary unit I has imaginary type (see <a class="reference internal" href="../../6/index.html#g-6"><span class="std std-ref">G.6</span></a>).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;math.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;complex.h&gt;</span>
<span class="cm">/* Multiply z * w ... */</span>
<span class="kt">double</span><span class="w"> </span><span class="k">complex</span><span class="w"> </span><span class="n">_Cmultd</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="k">complex</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="k">complex</span><span class="w"> </span><span class="n">w</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">       </span><span class="cp">#pragma STDC FP_CONTRACT OFF</span>
<span class="w">       </span><span class="kt">double</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">ac</span><span class="p">,</span><span class="w"> </span><span class="n">bd</span><span class="p">,</span><span class="w"> </span><span class="n">ad</span><span class="p">,</span><span class="w"> </span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="w">       </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">creal</span><span class="p">(</span><span class="n">z</span><span class="p">);</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cimag</span><span class="p">(</span><span class="n">z</span><span class="p">);</span>
<span class="w">       </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">creal</span><span class="p">(</span><span class="n">w</span><span class="p">);</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cimag</span><span class="p">(</span><span class="n">w</span><span class="p">);</span>
<span class="w">       </span><span class="n">ac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w">       </span><span class="n">bd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="p">;</span>
<span class="w">       </span><span class="n">ad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="p">;</span><span class="w">       </span><span class="n">bc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">       </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ac</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">bd</span><span class="p">;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ad</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bc</span><span class="p">;</span>
<span class="w">       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">               </span><span class="cm">/* Recover infinities that computed as NaN+iNaN ... */</span>
<span class="w">               </span><span class="kt">int</span><span class="w"> </span><span class="n">recalc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">isinf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">isinf</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// z is infinite</span>
<span class="w">                       </span><span class="cm">/* &quot;Box&quot; the infinity and change NaNs in the other factor to 0 */</span>
<span class="w">                       </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="n">isinf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">);</span>
<span class="w">                       </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="n">isinf</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">d</span><span class="p">))</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">);</span>
<span class="w">                       </span><span class="n">recalc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">               </span><span class="p">}</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">isinf</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">isinf</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// w is infinite</span>
<span class="w">                       </span><span class="cm">/* &quot;Box&quot; the infinity and change NaNs in the other factor to 0 */</span>
<span class="w">                       </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="n">isinf</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
<span class="w">                       </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="n">isinf</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">);</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">a</span><span class="p">))</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">);</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">b</span><span class="p">))</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
<span class="w">                       </span><span class="n">recalc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">               </span><span class="p">}</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">recalc</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">isinf</span><span class="p">(</span><span class="n">ac</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">isinf</span><span class="p">(</span><span class="n">bd</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="w">                                      </span><span class="n">isinf</span><span class="p">(</span><span class="n">ad</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">isinf</span><span class="p">(</span><span class="n">bc</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                       </span><span class="cm">/* Recover infinities from overflow by changing NaNs to 0 ... */</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">a</span><span class="p">))</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">);</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">b</span><span class="p">))</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">);</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">);</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">d</span><span class="p">))</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">);</span>
<span class="w">                       </span><span class="n">recalc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">               </span><span class="p">}</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">recalc</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                           </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFINITY</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">);</span>
<span class="w">                           </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFINITY</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
<div class="snum docutils container" id="g-5-1p7">
<p><a class="reference internal" href="#g-5-1p7"><span class="std std-ref">7</span></a></p>
</div>
<p>This implementation achieves the required treatment of infinities at the cost of only one isnan test in ordinary (finite) cases. It is less than ideal in that undue overflow and underflow may occur.</p>
<div class="snum docutils container" id="g-5-1p8">
<p><a class="reference internal" href="#g-5-1p8"><span class="std std-ref">8</span></a></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">EXAMPLE</span> <span class="pre">2</span></code> Division of two double _Complex operands could be implemented as follows.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;math.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;complex.h&gt;</span>
<span class="cm">/* Divide z / w ... */</span>
<span class="kt">double</span><span class="w"> </span><span class="k">complex</span><span class="w"> </span><span class="n">_Cdivd</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="k">complex</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="k">complex</span><span class="w"> </span><span class="n">w</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">       </span><span class="cp">#pragma STDC FP_CONTRACT OFF</span>
<span class="w">       </span><span class="kt">double</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">logbw</span><span class="p">,</span><span class="w"> </span><span class="n">denom</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="w">       </span><span class="kt">int</span><span class="w"> </span><span class="n">ilogbw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">       </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">creal</span><span class="p">(</span><span class="n">z</span><span class="p">);</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cimag</span><span class="p">(</span><span class="n">z</span><span class="p">);</span>
<span class="w">       </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">creal</span><span class="p">(</span><span class="n">w</span><span class="p">);</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cimag</span><span class="p">(</span><span class="n">w</span><span class="p">);</span>
<span class="w">       </span><span class="n">logbw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logb</span><span class="p">(</span><span class="n">fmax</span><span class="p">(</span><span class="n">fabs</span><span class="p">(</span><span class="n">c</span><span class="p">),</span><span class="w"> </span><span class="n">fabs</span><span class="p">(</span><span class="n">d</span><span class="p">)));</span>
<span class="w">       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isfinite</span><span class="p">(</span><span class="n">logbw</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">ilogbw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">logbw</span><span class="p">;</span>
<span class="w">              </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scalbn</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">ilogbw</span><span class="p">);</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scalbn</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">ilogbw</span><span class="p">);</span>
<span class="w">       </span><span class="p">}</span>
<span class="w">       </span><span class="n">denom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="p">;</span>
<span class="w">       </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scalbn</span><span class="p">((</span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">denom</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">ilogbw</span><span class="p">);</span>
<span class="w">       </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scalbn</span><span class="p">((</span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">denom</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">ilogbw</span><span class="p">);</span>
<span class="w">       </span><span class="cm">/* Recover infinities and zeros that computed as NaN+iNaN;                 */</span>
<span class="w">       </span><span class="cm">/* the only cases are nonzero/zero, infinite/finite, and finite/infinite, ... */</span>
<span class="w">       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">             </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">denom</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">                   </span><span class="p">(</span><span class="o">!</span><span class="n">isnan</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">isnan</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                   </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="n">INFINITY</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">                   </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="n">INFINITY</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">             </span><span class="p">}</span>
<span class="w">             </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">isinf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">isinf</span><span class="p">(</span><span class="n">b</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">                   </span><span class="n">isfinite</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">isfinite</span><span class="p">(</span><span class="n">d</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                   </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="n">isinf</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">                        </span><span class="n">a</span><span class="p">);</span>
<span class="w">                   </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="n">isinf</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">                        </span><span class="n">b</span><span class="p">);</span>
<span class="w">                   </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFINITY</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">);</span>
<span class="w">                   </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFINITY</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">);</span>
<span class="w">             </span><span class="p">}</span>
<span class="w">             </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isinf</span><span class="p">(</span><span class="n">logbw</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">                   </span><span class="n">isfinite</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">isfinite</span><span class="p">(</span><span class="n">b</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                   </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="n">isinf</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">                        </span><span class="n">c</span><span class="p">);</span>
<span class="w">                   </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copysign</span><span class="p">(</span><span class="n">isinf</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">                        </span><span class="n">d</span><span class="p">);</span>
<span class="w">                   </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">);</span>
<span class="w">                   </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">);</span>
<span class="w">             </span><span class="p">}</span>
<span class="w">       </span><span class="p">}</span>
<span class="w">       </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
</pre></div>
</div>
<div class="snum docutils container" id="g-5-1p9">
<p><a class="reference internal" href="#g-5-1p9"><span class="std std-ref">9</span></a></p>
</div>
<p>Scaling the denominator alleviates the main overflow and underflow problem, which is more serious than for multiplication. In the spirit of the multiplication example above, this code does not defend against overflow and underflow in the calculation of the numerator. Scaling with the scalbn function, instead of with division, provides better roundoff characteristics.</p>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="note325" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>These properties are already implied for those cases covered in the tables, but are required for all cases (at least where the state for CX_LIMITED_RANGE is ‚Äúoff‚Äù).</p>
</aside>
</aside>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="G.5 Binary operators" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../2/index.html" class="btn btn-neutral float-right" title="G.5.2 Additive operators" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>