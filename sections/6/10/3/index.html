<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>6.10.3 Macro replacement &mdash; C99 Language Standard  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/brand.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="6.10.3.1 Argument substitution" href="1/index.html" />
    <link rel="prev" title="6.10.2 Source file inclusion" href="../2/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            C99 Language Standard
              <img src="../../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../foreword.html">Foreword</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../1/index.html">1. Scope</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2/index.html">2. Normative references</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../3/index.html">3. Terms, definitions, and symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../4/index.html">4. Conformance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../5/index.html">5. Environment</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">6. Language</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../1/index.html">6.1 Notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../2/index.html">6.2 Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../3/index.html">6.3 Conversions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../4/index.html">6.4 Lexical elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../5/index.html">6.5 Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../6/index.html">6.6 Constant expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../7/index.html">6.7 Declarations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../8/index.html">6.8 Statements and blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../9/index.html">6.9 External definitions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">6.10 Preprocessing directives</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../1/index.html">6.10.1 Conditional inclusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../2/index.html">6.10.2 Source file inclusion</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">6.10.3 Macro replacement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="1/index.html">6.10.3.1 Argument substitution</a></li>
<li class="toctree-l4"><a class="reference internal" href="2/index.html">6.10.3.2 The # operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="3/index.html">6.10.3.3 The ## operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="4/index.html">6.10.3.4 Rescanning and further replacement</a></li>
<li class="toctree-l4"><a class="reference internal" href="5/index.html">6.10.3.5 Scope of macro definitions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../4/index.html">6.10.4 Line control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../5/index.html">6.10.5 Error directive</a></li>
<li class="toctree-l3"><a class="reference internal" href="../6/index.html">6.10.6 Pragma directive</a></li>
<li class="toctree-l3"><a class="reference internal" href="../7/index.html">6.10.7 Null directive</a></li>
<li class="toctree-l3"><a class="reference internal" href="../8/index.html">6.10.8 Predefined macro names</a></li>
<li class="toctree-l3"><a class="reference internal" href="../9/index.html">6.10.9 Pragma operator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../11/index.html">6.11 Future language directions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../7/index.html">7. Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../8/index.html">Annex A</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../9/index.html">Annex B</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../10/index.html">Annex C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../11/index.html">Annex D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../12/index.html">Annex E</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../13/index.html">Annex F</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../14/index.html">Annex G</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../15/index.html">Annex H</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../16/index.html">Annex I</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../17/index.html">Annex J</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../18/index.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">C99 Language Standard</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">6. Language</a></li>
          <li class="breadcrumb-item"><a href="../index.html">6.10 Preprocessing directives</a></li>
      <li class="breadcrumb-item active">6.10.3 Macro replacement</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="../2/index.html" class="btn btn-neutral float-left" title="6.10.2 Source file inclusion" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="1/index.html" class="btn btn-neutral float-right" title="6.10.3.1 Argument substitution" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="macro-replacement">
<span id="id1"></span><h1>6.10.3 Macro replacement<a class="headerlink" href="#macro-replacement" title="Permalink to this heading">ÔÉÅ</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="1/index.html">6.10.3.1 Argument substitution</a></li>
<li class="toctree-l1"><a class="reference internal" href="2/index.html">6.10.3.2 The # operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="3/index.html">6.10.3.3 The ## operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="4/index.html">6.10.3.4 Rescanning and further replacement</a></li>
<li class="toctree-l1"><a class="reference internal" href="5/index.html">6.10.3.5 Scope of macro definitions</a></li>
</ul>
</div>
<p class="rubric">Constraints</p>
<div class="snum docutils container" id="p1">
<p><a class="reference internal" href="#p1"><span class="std std-ref">1</span></a></p>
</div>
<p>Two replacement lists are identical if and only if the preprocessing tokens in both have the same number, ordering, spelling, and white-space separation, where all white-space separations are considered identical.</p>
<div class="snum docutils container" id="p2">
<p><a class="reference internal" href="#p2"><span class="std std-ref">2</span></a></p>
</div>
<p>An identifier currently defined as an object-like macro shall not be redefined by another <span class="c-texpr sig sig-inline highlight c">#define</span> preprocessing directive unless the second definition is an object-like macro definition and the two replacement lists are identical. Likewise, an identifier currently defined as a function-like macro shall not be redefined by another <span class="c-texpr sig sig-inline highlight c">#define</span> preprocessing directive unless the second definition is a function-like macro definition that has the same number and spelling of parameters, and the two replacement lists are identical.</p>
<div class="snum docutils container" id="p3">
<p><a class="reference internal" href="#p3"><span class="std std-ref">3</span></a></p>
</div>
<p>There shall be white-space between the identifier and the replacement list in the definition of an object-like macro.</p>
<div class="snum docutils container" id="p4">
<p><a class="reference internal" href="#p4"><span class="std std-ref">4</span></a></p>
</div>
<p>If the identifier-list in the macro definition does not end with an ellipsis, the number of arguments (including those arguments consisting of no preprocessing tokens) in an invocation of a function-like macro shall equal the number of parameters in the macro definition. Otherwise, there shall be more arguments in the invocation than there are parameters in the macro definition (excluding the ...). There shall exist a ) preprocessing token that terminates the invocation.</p>
<div class="snum docutils container" id="p5">
<p><a class="reference internal" href="#p5"><span class="std std-ref">5</span></a></p>
</div>
<p>The identifier __VA_ARGS__ shall occur only in the replacement-list of a function-like macro that uses the ellipsis notation in the parameters.</p>
<div class="snum docutils container" id="p6">
<p><a class="reference internal" href="#p6"><span class="std std-ref">6</span></a></p>
</div>
<p>A parameter identifier in a function-like macro shall be uniquely declared within its scope.</p>
<p class="rubric">Semantics</p>
<div class="snum docutils container" id="p7">
<p><a class="reference internal" href="#p7"><span class="std std-ref">7</span></a></p>
</div>
<p>The identifier immediately following the define is called the macro name. There is one name space for macro names. Any white-space characters preceding or following the replacement list of preprocessing tokens are not considered part of the replacement list for either form of macro.</p>
<div class="snum docutils container" id="p8">
<p><a class="reference internal" href="#p8"><span class="std std-ref">8</span></a></p>
</div>
<p>If a # preprocessing token, followed by an identifier, occurs lexically at the point at which a preprocessing directive could begin, the identifier is not subject to macro replacement.</p>
<div class="snum docutils container" id="p9">
<p><a class="reference internal" href="#p9"><span class="std std-ref">9</span></a></p>
</div>
<p>A preprocessing directive of the form</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># define identifier replacement-list new-line
</pre></div>
</div>
<p>defines an object-like macro that causes each subsequent instance of the macro name<a class="footnote-reference brackets" href="#note149" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> to be replaced by the replacement list of preprocessing tokens that constitute the remainder of the directive. The replacement list is then rescanned for more macro names as specified below.</p>
<div class="snum docutils container" id="p10">
<p><a class="reference internal" href="#p10"><span class="std std-ref">10</span></a></p>
</div>
<p>A preprocessing directive of the form</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># define identifier lparen identifier-listopt ) replacement-list new-line
# define identifier lparen ... ) replacement-list new-line
# define identifier lparen identifier-list , ... ) replacement-list new-line
</pre></div>
</div>
<p>defines a function-like macro with parameters, whose use is similar syntactically to a function call. The parameters are specified by the optional list of identifiers, whose scope extends from their declaration in the identifier list until the new-line character that terminates the <span class="c-texpr sig sig-inline highlight c">#define</span> preprocessing directive. Each subsequent instance of the function-like macro name followed by a ( as the next preprocessing token introduces the sequence of preprocessing tokens that is replaced by the replacement list in the definition (an invocation of the macro). The replaced sequence of preprocessing tokens is terminated by the matching ) preprocessing token, skipping intervening matched pairs of left and right parenthesis preprocessing tokens. Within the sequence of preprocessing tokens making up an invocation of a function-like macro, new-line is considered a normal white-space character.</p>
<div class="snum docutils container" id="p11">
<p><a class="reference internal" href="#p11"><span class="std std-ref">11</span></a></p>
</div>
<p>The sequence of preprocessing tokens bounded by the outside-most matching parentheses forms the list of arguments for the function-like macro. The individual arguments within the list are separated by comma preprocessing tokens, but comma preprocessing tokens between matching inner parentheses do not separate arguments. If there are sequences of preprocessing tokens within the list of arguments that would otherwise act as preprocessing directives,<a class="footnote-reference brackets" href="#note150" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> the behavior is undefined.</p>
<div class="snum docutils container" id="p12">
<p><a class="reference internal" href="#p12"><span class="std std-ref">12</span></a></p>
</div>
<p>If there is a ... in the identifier-list in the macro definition, then the trailing arguments, including any separating comma preprocessing tokens, are merged to form a single item: the variable arguments. The number of arguments so combined is such that, following merger, the number of arguments is one more than the number of parameters in the macro definition (excluding the ...).</p>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="note149" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p>Since, by macro-replacement time, all character constants and string literals are preprocessing tokens, not sequences possibly containing identifier-like subsequences (see <a class="reference internal" href="../../../5/1/1/2/index.html#id1"><span class="std std-ref">5.1.1.2</span></a>, translation phases), they are never scanned for macro names or parameters.</p>
</aside>
<aside class="footnote brackets" id="note150" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p>Despite the name, a non-directive is a preprocessing directive.</p>
</aside>
</aside>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../2/index.html" class="btn btn-neutral float-left" title="6.10.2 Source file inclusion" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="1/index.html" class="btn btn-neutral float-right" title="6.10.3.1 Argument substitution" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>